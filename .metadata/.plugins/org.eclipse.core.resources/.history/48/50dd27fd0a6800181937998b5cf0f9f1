package it.finsoft.one_to_many.controller;

import org.springframework.beans.factory.annotation.Autowired;

import org.springframework.web.bind.annotation.*;

import it.finsoft.one_to_many.model.Movie;
import it.finsoft.one_to_many.model.MovieDetail;
import it.finsoft.one_to_many.repository.MovieRepository;

@RestController
@RequestMapping("/rest")
public class MovieController {

	@Autowired
	MovieRepository movierepo;
	
	@GetMapping("/movie")
	public Iterable<Movie> qualcosa()
	{
		Movie mv1=new Movie();
		Movie mv2=new Movie();
		
		
		MovieDetail mvdetail1 = new MovieDetail("detail1", "description1", null);
		MovieDetail mvdetail2 = new MovieDetail("detail2", "description2", null);
		MovieDetail mvdetail3 = new MovieDetail("detail3", "description3", null);
		MovieDetail mvdetail4 = new MovieDetail("detail4", "description4", null);
		mv1.setName("movie1");
		mv2.setName("movie2");
		mv1.getMoviedetails().add(mvdetail1);
		mv1.getMoviedetails().add(mvdetail2);
		mv2.getMoviedetails().add(mvdetail3);
		mv2.getMoviedetails().add(mvdetail4);
		
		movierepo.save(mv1);
		movierepo.save(mv2);
		return movierepo.findAll();
	}
}
